<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸŽ¯ Countdown</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.0/dist/confetti.browser.min.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap');

    body {
      font-family: 'Orbitron', sans-serif;
      background: radial-gradient(circle at center, #1a1a2e, #16213e);
      color: #fff;
      overflow-x: hidden;
    }

    .glow {
      text-shadow: 0 0 10px #00e0ff, 0 0 20px #00e0ff, 0 0 30px #00e0ff;
    }

    .neon-box {
      box-shadow: 0 0 10px #00fff2, 0 0 20px #00fff2, 0 0 40px #00fff2;
    }

    .fireworks {
      position: fixed;
      width: 100%;
      height: 100%;
      top: 0; left: 0;
      z-index: -1;
      pointer-events: none;
    }

    #preloader {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    .loader {
      width: 60px;
      height: 60px;
      border: 6px solid #00fff2;
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4 relative">

  <!-- Preloader -->
  <div id="preloader">
    <div class="loader"></div>
  </div>

  <!-- Fireworks Canvas -->
  <canvas id="fireworks" class="fireworks"></canvas>

  <!-- Background Music -->
  <audio id="bgMusic" autoplay loop>
    <source src="https://www.soundhelix.com/examples/mp3/SoundHelix-Song-1.mp3" type="audio/mp3">
  </audio>

  <!-- Setup Form -->
  <div id="setup" class="text-center space-y-6">
    <h1 class="text-4xl glow">ðŸŽ¯ Set Your Event Countdown</h1>

    <input type="text" id="eventName" placeholder="Enter event name..." class="text-black px-4 py-2 rounded-md w-full max-w-sm">
    <input type="datetime-local" id="eventDate" class="text-black px-4 py-2 rounded-md w-full max-w-sm">

    <input type="file" id="eventImage" accept="image/*" class="mt-2 text-white file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-cyan-600 file:text-white hover:file:bg-cyan-700">

    <div id="imagePreview" class="mt-4 hidden">
      <img id="previewImg" class="mx-auto rounded-xl max-h-64 border-4 border-cyan-400 shadow-lg" />
    </div>

    <button onclick="startCountdown()" class="mt-4 px-6 py-2 bg-cyan-500 hover:bg-cyan-700 rounded-xl text-white font-bold glow">
      ðŸš€ Start Countdown
    </button>
  </div>

  <!-- Main Countdown -->
  <div id="main-content" class="text-center space-y-6 hidden">
    <h1 id="title" class="text-4xl md:text-6xl font-bold glow tracking-widest">ðŸ”¥ Countdown</h1>

    <div id="finalImage" class="mt-6 hidden">
      <img id="eventImgShown" class="mx-auto rounded-xl max-h-64 border-4 border-cyan-400 shadow-lg" />
    </div>

    <div id="countdown" class="flex justify-center gap-4 text-4xl md:text-5xl font-mono mt-6">
      <div class="neon-box px-6 py-4 rounded-2xl bg-black bg-opacity-40">
        <span id="days">00</span><div class="text-xs mt-1">DAYS</div>
      </div>
      <div class="neon-box px-6 py-4 rounded-2xl bg-black bg-opacity-40">
        <span id="hours">00</span><div class="text-xs mt-1">HRS</div>
      </div>
      <div class="neon-box px-6 py-4 rounded-2xl bg-black bg-opacity-40">
        <span id="minutes">00</span><div class="text-xs mt-1">MIN</div>
      </div>
      <div class="neon-box px-6 py-4 rounded-2xl bg-black bg-opacity-40">
        <span id="seconds">00</span><div class="text-xs mt-1">SEC</div>
      </div>
    </div>

    <p class="text-xl text-gray-300">Donâ€™t blink. You donâ€™t wanna miss this. ðŸš€</p>
  </div>

  <script>
    let countdownInterval;
    let celebrationStarted = false;
    let imageURL = "";

    // Preloader
    window.addEventListener("load", () => {
      document.getElementById("preloader").style.display = "none";
    });

    // Image Preview
    document.getElementById("eventImage").addEventListener("change", function () {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function (e) {
          imageURL = e.target.result;
          document.getElementById("previewImg").src = imageURL;
          document.getElementById("imagePreview").classList.remove("hidden");
        };
        reader.readAsDataURL(file);
      }
    });

    function startCountdown() {
      const name = document.getElementById("eventName").value.trim();
      const dateInput = document.getElementById("eventDate").value;

      if (!name || !dateInput) {
        alert("Please enter both event name and date!");
        return;
      }

      const targetDate = new Date(dateInput).getTime();
      document.getElementById("title").textContent = `ðŸ”¥ ${name.toUpperCase()} Starts In`;

      document.getElementById("setup").style.display = "none";
      document.getElementById("main-content").classList.remove("hidden");

      if (imageURL) {
        document.getElementById("eventImgShown").src = imageURL;
        document.getElementById("finalImage").classList.remove("hidden");
      }

      countdownInterval = setInterval(() => {
        const now = new Date().getTime();
        const gap = targetDate - now;

        const second = 1000;
        const minute = second * 60;
        const hour = minute * 60;
        const day = hour * 24;

        const d = Math.floor(gap / day);
        const h = Math.floor((gap % day) / hour);
        const m = Math.floor((gap % hour) / minute);
        const s = Math.floor((gap % minute) / second);

        document.getElementById("days").innerText = d.toString().padStart(2, '0');
        document.getElementById("hours").innerText = h.toString().padStart(2, '0');
        document.getElementById("minutes").innerText = m.toString().padStart(2, '0');
        document.getElementById("seconds").innerText = s.toString().padStart(2, '0');

        if (gap <= 0 && !celebrationStarted) {
          clearInterval(countdownInterval);
          celebrationStarted = true;
          document.getElementById("countdown").innerHTML = "<span class='text-3xl glow'>ðŸŽ‰ It's Time! ðŸŽ‰</span>";
          startCelebration();
        }
      }, 1000);
    }

    function startCelebration() {
      const duration = 5000;
      const end = Date.now() + duration;

      const confettiFrame = () => {
        confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
        confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });

        if (Date.now() < end) {
          requestAnimationFrame(confettiFrame);
        }
      };

      confettiFrame();

      const canvas = document.getElementById("fireworks");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;

      const colors = ["#ff0040", "#ff6600", "#00ccff", "#33ff33"];
      let particles = [];

      function FireworkParticle() {
        this.x = canvas.width / 2;
        this.y = canvas.height / 2;
        this.radius = Math.random() * 4 + 1;
        this.color = colors[Math.floor(Math.random() * colors.length)];
        this.speedX = (Math.random() - 0.5) * 10;
        this.speedY = (Math.random() - 0.5) * 10;
        this.alpha = 1;
      }

      function createFireworks() {
        for (let i = 0; i < 100; i++) {
          particles.push(new FireworkParticle());
        }
      }

      function drawFireworks() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach((p, i) => {
          p.x += p.speedX;
          p.y += p.speedY;
          p.alpha -= 0.01;
          if (p.alpha <= 0) particles.splice(i, 1);
          ctx.globalAlpha = p.alpha;
          ctx.beginPath();
          ctx.arc(p.x, p.y, p.radius, 0, Math.PI * 2, false);
          ctx.fillStyle = p.color;
          ctx.fill();
        });
        ctx.globalAlpha = 1;
        if (particles.length > 0) requestAnimationFrame(drawFireworks);
      }

      createFireworks();
      drawFireworks();
    }
  </script>
</body>
</html>
